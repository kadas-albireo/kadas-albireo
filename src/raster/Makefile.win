QGTOP=../../

DLL=qgis_raster.dll

all: libs $(DLL)

libs:
	$(MAKE) -f Makefile libqgis_raster.la

$(DLL): .libs/libqgis_raster.a
	$(CXX) -shared -o $(DLL) \
		-Wl,--out-implib=lib$(DLL).a \
		-Wl,--export-all-symbols \
		-Wl,--enable-auto-import \
		-Wl,--whole-archive .libs/libqgis_raster.a \
		-Wl,--no-whole-archive \
			$(GUI_A) $(CORE_A) $(LEGEND_A) $(PROJSEL_A) \
			$(GUI_A) $(CORE_A) $(COMPOSER_A) $(GUI_A) \
			$(GDAL_LDADD) -lproj -lsqlite3 -lpq \
			$(QT_LDADD) \
			-lwsock32 -lmingw32
	$(STRIP) $@

install: all
	$(INSTALL) -m 755 $(DLL) $(DLLDIR)/$(DLL)

include $(QGTOP)/Makefile.win.rules
